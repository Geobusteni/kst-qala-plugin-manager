(()=>{var e={750:()=>{window.QalaPluginManager=window.QalaPluginManager||{},window.QalaPluginManager.hasFullAccess=function(){return document.body.classList.contains("qala-has-full-access")},window.QalaPluginManager.noticesHidden=function(){return document.body.classList.contains("qala-notices-hidden")},window.QalaPluginManager.noticesVisible=function(){return document.body.classList.contains("qala-notices-visible")},function(){"use strict";const e={init:function(){window.QalaPluginManager.noticesHidden()?"undefined"!=typeof qalaAllowlistPatterns&&qalaAllowlistPatterns.patterns?(console.log("Qala Content Matcher: Initializing with",qalaAllowlistPatterns.patterns.length,"patterns"),this.processNotices()):console.log("Qala Content Matcher: No allowlist patterns defined"):console.log("Qala Content Matcher: Notices not hidden - skipping")},processNotices:function(){const e=document.querySelectorAll([".notice",".updated",".update-nag",".error",'div[id^="message"]','div[class*="-notice"]',"#ajax-response .notice","#ajax-response > div"].join(", "));console.log("Qala Content Matcher: Found",e.length,"notice elements");let t=0,a=0;e.forEach(e=>{if(e.hasAttribute("data-qala-processed"))return void a++;e.setAttribute("data-qala-processed","true");const n=this.getNoticeText(e);n&&n.trim()&&console.log("Qala Content Matcher: Checking notice -",n.substring(0,80)),this.matchesAnyPattern(n)&&(e.setAttribute("data-qala-show","true"),t++,console.log("Qala Content Matcher: âœ“ MATCHED -",n.substring(0,80)))}),a>0&&console.log("Qala Content Matcher: Skipped",a,"already processed notices"),console.log("Qala Content Matcher: Matched",t,"new notices")},getNoticeText:function(e){return e.textContent||e.innerText||""},matchesAnyPattern:function(e){if(!e)return!1;for(let t=0;t<qalaAllowlistPatterns.patterns.length;t++){const a=qalaAllowlistPatterns.patterns[t];console.log("Qala Content Matcher: Testing pattern",a.value,"type:",a.type,"against text:",e.substring(0,80));const n=this.matchesPattern(e,a.value,a.type);if(console.log("Qala Content Matcher: Pattern match result:",n),n)return console.log("Qala Content Matcher: Pattern MATCHED!"),!0}return!1},matchesPattern:function(e,t,a){switch(a){case"exact":return e===t;case"wildcard":return this.matchesWildcard(e,t);case"regex":return this.matchesRegex(e,t);default:return!1}},matchesWildcard:function(e,t){const a=t.replace(/[.+?^${}()|[\]\\]/g,"\\$&");return new RegExp("^"+a.replace(/\*/g,".*")+"$","i").test(e)},matchesRegex:function(e,t){try{let a=t,n="i";console.log("Qala Content Matcher: matchesRegex - Original pattern:",t);const o=t.match(/^\/(.*)\/([gimsuvy]*)$/);if(o){a=o[1];const e=o[2];console.log("Qala Content Matcher: Extracted pattern body:",a),console.log("Qala Content Matcher: Extracted flags:",e),n=[...new Set((e+"i").split(""))].join(""),console.log("Qala Content Matcher: Combined flags:",n)}else console.log("Qala Content Matcher: No delimiters found, using pattern as-is");const s=new RegExp(a,n);console.log("Qala Content Matcher: Created regex:",s);const i=s.test(e);return console.log("Qala Content Matcher: Regex test result:",i),i}catch(e){return console.error("Qala Content Matcher: Invalid regex pattern",t,e),!1}},startObserver:function(){if(!window.QalaPluginManager.noticesHidden())return;if("undefined"==typeof qalaAllowlistPatterns||!qalaAllowlistPatterns.patterns)return;const e=new MutationObserver(e=>{let t=!1;e.forEach(e=>{e.addedNodes.length>0&&e.addedNodes.forEach(e=>{if(1===e.nodeType){const a=e.classList&&(e.classList.contains("notice")||e.classList.contains("updated")||e.classList.contains("error")||"ajax-response"===e.id),n=e.querySelector&&(e.querySelector(".notice")||e.querySelector(".updated")||e.querySelector(".error")||e.querySelector('[class*="-notice"]'));(a||n)&&(t=!0)}})}),t&&(console.log("Qala Content Matcher: New notices detected via MutationObserver"),setTimeout(()=>{this.processNotices()},100))});e.observe(document.body,{childList:!0,subtree:!0}),console.log("Qala Content Matcher: MutationObserver started - watching for AJAX notices"),this.observer=e},stopObserver:function(){this.observer&&(this.observer.disconnect(),console.log("Qala Content Matcher: MutationObserver stopped"))}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",function(){e.init(),e.startObserver()}):(e.init(),e.startObserver()),setTimeout(function(){e.processNotices()},500),setTimeout(function(){e.processNotices()},1500),setTimeout(function(){e.processNotices()},3e3),window.QalaPluginManager.NoticeContentMatcher=e}(),function(e){"use strict";const t={init:function(){this.bindEvents()},bindEvents:function(){e("#wp-admin-bar-qala-notice-toggle a").on("click",this.handleClick.bind(this))},handleClick:function(e){e.preventDefault(),this.isToggling||this.toggleNoticeVisibility()},toggleNoticeVisibility:function(){const t=this,a=e("#wp-admin-bar-qala-notice-toggle").find(".qala-notice-toggle-wrapper"),n=a.html();this.isToggling=!0,this.setLoadingState(a),e.ajax({url:qalaAdminBarToggle.ajaxUrl,type:"POST",data:{action:qalaAdminBarToggle.action,nonce:qalaAdminBarToggle.nonce},dataType:"json",success:function(e){e.success?t.handleSuccess(e.data,a):t.handleError(e.data,a,n)},error:function(e,o,s){t.handleError({message:qalaAdminBarToggle.strings.error},a,n)},complete:function(){t.isToggling=!1}})},setLoadingState:function(e){e.addClass("qala-loading"),e.find(".qala-toggle-state").text(qalaAdminBarToggle.strings.loading)},handleSuccess:function(e,t){e.new_title&&t.html(e.new_title),this.showNotice(e.message,"success"),setTimeout(function(){window.location.reload()},500)},handleError:function(e,t,a){t.removeClass("qala-loading"),t.html(a);const n=e&&e.message?e.message:qalaAdminBarToggle.strings.error;this.showNotice(n,"error")},showNotice:function(t,a){const n=e("<div>",{class:"notice qala-ajax-notice "+("success"===a?"notice-success":"notice-error")+" is-dismissible",html:"<p>"+t+"</p>"});e(".wrap").length?e(".wrap").first().prepend(n):e("#wpbody-content").prepend(n),setTimeout(function(){n.fadeOut(300,function(){e(this).remove()})},3e3)},isToggling:!1};e(document).ready(function(){e("#wp-admin-bar-qala-notice-toggle").length&&t.init()})}(jQuery),function(e){"use strict";const t={init:function(){this.bindEvents()},bindEvents:function(){console.log("Qala Admin Page: Binding events..."),e("#qala-add-pattern-btn").on("click",this.handleAddPattern.bind(this)),console.log("Qala Admin Page: Bound click handler to #qala-add-pattern-btn"),e("#qala-new-pattern").on("keypress",function(e){13===e.which&&(e.preventDefault(),t.handleAddPattern())}),e(document).on("click",".qala-add-to-allowlist",this.handleAddFromLog.bind(this)),e(document).on("click",".qala-remove-from-allowlist",this.handleRemovePattern.bind(this)),console.log("Qala Admin Page: All events bound")},handleAddPattern:function(a){console.log("Qala Admin Page: handleAddPattern called",a),a&&a.preventDefault();const n=e("#qala-new-pattern").val().trim(),o=e("#qala-pattern-type").val(),s=e("#qala-add-pattern-btn"),i=e("#qala-add-pattern-message");if(console.log("Qala Admin Page: Pattern:",n,"Type:",o),!n)return console.log("Qala Admin Page: Empty pattern - showing error"),void this.showMessage(i,qalaAdminPage.strings.emptyPattern,"error");s.prop("disabled",!0).addClass("qala-loading"),i.hide(),e.ajax({url:qalaAdminPage.ajaxUrl,type:"POST",data:{action:"qala_add_allowlist_pattern",nonce:qalaAdminPage.nonces.addPattern,pattern:n,pattern_type:o},success:function(a){if(a.success)t.showMessage(i,qalaAdminPage.strings.addSuccess,"success"),e("#qala-new-pattern").val(""),setTimeout(function(){location.reload()},1e3);else{const e=a.data&&a.data.message?a.data.message:qalaAdminPage.strings.addError;t.showMessage(i,e,"error")}},error:function(e,a,n){console.error("AJAX error:",n),t.showMessage(i,qalaAdminPage.strings.addError,"error")},complete:function(){s.prop("disabled",!1).removeClass("qala-loading")}})},handleAddFromLog:function(t){t.preventDefault();const a=e(t.currentTarget),n=a.data("pattern"),o=a.data("pattern-type")||"exact",s=a.closest("tr");a.prop("disabled",!0).addClass("qala-loading"),e.ajax({url:qalaAdminPage.ajaxUrl,type:"POST",data:{action:"qala_add_allowlist_pattern",nonce:qalaAdminPage.nonces.addPattern,pattern:n,pattern_type:o},success:function(e){if(e.success)s.css("background-color","#d4edda"),setTimeout(function(){location.reload()},1e3);else{const t=e.data&&e.data.message?e.data.message:qalaAdminPage.strings.addError;alert(t),a.prop("disabled",!1).removeClass("qala-loading")}},error:function(e,t,n){console.error("AJAX error:",n),alert(qalaAdminPage.strings.addError),a.prop("disabled",!1).removeClass("qala-loading")}})},handleRemovePattern:function(t){t.preventDefault();const a=e(t.currentTarget),n=a.data("pattern"),o=a.closest("tr");confirm(qalaAdminPage.strings.confirmRemove)&&(a.prop("disabled",!0).addClass("qala-loading"),e.ajax({url:qalaAdminPage.ajaxUrl,type:"POST",data:{action:"qala_remove_allowlist_pattern",nonce:qalaAdminPage.nonces.removePattern,pattern:n},success:function(t){if(t.success)o.fadeOut(300,function(){e(this).remove(),0===o.closest("tbody").find("tr").length&&location.reload()});else{const e=t.data&&t.data.message?t.data.message:qalaAdminPage.strings.removeError;alert(e),a.prop("disabled",!1).removeClass("qala-loading")}},error:function(e,t,n){console.error("AJAX error:",n),alert(qalaAdminPage.strings.removeError),a.prop("disabled",!1).removeClass("qala-loading")}}))},showMessage:function(e,t,a){e.removeClass("success error info").addClass(a).html(t).fadeIn(200),"success"===a&&setTimeout(function(){e.fadeOut(200)},5e3)}};e(document).ready(function(){console.log("Qala Admin Page: Document ready"),console.log("Qala Admin Page: qalaAdminPage defined?","undefined"!=typeof qalaAdminPage),console.log("Qala Admin Page: Add button exists?",e("#qala-add-pattern-btn").length>0),"undefined"!=typeof qalaAdminPage?(console.log("Qala Admin Page: Initializing..."),t.init(),console.log("Qala Admin Page: Initialized successfully")):console.log("Qala Admin Page: qalaAdminPage not defined - skipping initialization")})}(jQuery)}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,a),s.exports}(()=>{"use strict";a(750)})()})();